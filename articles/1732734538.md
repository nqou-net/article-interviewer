# GitHub Copilot Tasks で「ウイスキーへの再入門」記事を作成した話

> AIエージェントにブログ記事作成を依頼する際の試行錯誤と、そこから得られた学びの解説記事

## はじめに

この記事では、GitHub Copilot Tasks を使って「ウイスキーへの再入門」という記事を作成した際のセッションを解説します。

最初の試み（PR #11）では差分が大きくなりすぎて失敗しましたが、エージェントガイドラインを更新した後の再挑戦（PR #13）では成功しました。この体験から、AIエージェントへの指示の出し方について、多くのことを学ぶことができました。

## このセッションで学べること

- AIエージェントへの指示の出し方と注意点
- 「差分が大きくなりすぎる」問題とその対策
- エージェントガイドラインの重要性
- Hugo ショートコード（Amazon リンク）の活用方法
- セッションログの読み方と注意点

## セッションの概要

### 目的

このセッションでは、Hugo で構築されたブログサイト（www.nqou.net）に「ウイスキーへの再入門」という趣味に関する記事を追加することを目指しました。

### 登場人物

- **ユーザー（筆者）**: ウイスキー記事の作成を依頼した人
- **AI エージェント**: GitHub Copilot Tasks（コード変更やファイル作成を自動で行う）

### 関連リソース

| リソース | URL | 説明 |
|---------|-----|------|
| PR #11 | https://github.com/nqou-net/www.nqou.net/pull/11 | 最初の試み（差分が大きすぎて失敗） |
| PR #11 セッション | https://github.com/copilot/tasks/pull/PR_kwDOJQnkT861RBwf | PR #11 の Copilot Tasks セッション |
| PR #13 | https://github.com/nqou-net/www.nqou.net/pull/13 | 再挑戦（成功） |
| PR #13 セッション | https://github.com/copilot/tasks/pull/PR_kwDOJQnkT861Yyvs | PR #13 の Copilot Tasks セッション |

## ステップごとの解説

### ステップ1: 最初の試み（PR #11）

**何が起きたか:**
ウイスキーに関する記事を作成するよう、GitHub Copilot Tasks に依頼しました。

**問題点:**
エージェントが作成した変更の「差分（diff）」が大きくなりすぎてしまいました。

**初心者向け補足:**
> 💡 「差分（diff）」とは、変更前と変更後のファイルの違いのことです。例えば、1行だけ修正した場合は差分が小さく、100行追加した場合は差分が大きくなります。

**なぜこれが問題だったのか:**

1. **レビューの困難さ**: 差分が大きいと、人間がすべての変更を確認するのが大変になります
2. **マージコンフリクトのリスク**: 変更箇所が多いと、他の変更と衝突しやすくなります
3. **問題の特定が困難**: 何か問題があった時、どの変更が原因か特定しにくくなります

わかりやすく言えば、「引っ越しの時に一度に全部の荷物を運ぼうとして、何がどこにあるかわからなくなった」ような状況です。

### ステップ2: エージェントガイドラインの更新

**何が起きたか:**
PR #11 の失敗を受けて、エージェントガイドライン（AGENTS.md や関連ファイル）を更新しました。

**なぜこれをしたのか:**
AIエージェントに対して、より適切な指示を与えるためです。ガイドラインを明確にすることで、エージェントが「どこまでやるべきか」「何を避けるべきか」を理解しやすくなります。

**初心者向け補足:**
> 💡 「エージェントガイドライン」とは、AIエージェントに対する「取扱説明書」のようなものです。「こういう時はこうしてほしい」「これはやらないでほしい」といったルールを事前に定義しておきます。

**改善のポイント（推測を含む）:**

- 変更の範囲を限定するルールの追加
- 一度に行う作業の量を制限
- 既存のファイルを大きく変更しないよう指示
- 新規ファイルの追加を中心とするよう方向付け

### ステップ3: 再挑戦（PR #13）

**何が起きたか:**
エージェントガイドラインを更新した後、改めてウイスキー記事の作成を依頼しました。今回は成功し、適切なサイズの差分で記事が完成しました。

**成功の要因:**

1. **明確なガイドライン**: エージェントが何をすべきか、何を避けるべきかが明確になった
2. **スコープの制限**: 記事作成に必要最小限の変更に絞られた
3. **具体的な指示**: Amazon ショートコードの使用など、具体的な形式を指定した

### ステップ4: Amazon ショートコードの活用

**何が起きたか:**
記事内でウイスキーの商品を紹介するために、Hugo の Amazon ショートコードを使用するよう指示しました。

**具体的な書き方:**

```text
{{< amazon asin="B003UMOHT0" title="AnCnoc(アンノック) シングルモルト アンノック12年">}}
```

**初心者向け補足:**
> 💡 「ショートコード」とは、Hugo（静的サイトジェネレーター）の機能で、複雑な HTML を短いコードで表現できる仕組みです。上記の例では、ASIN（Amazon の商品識別番号）とタイトルを指定するだけで、見栄えの良い商品リンクが自動生成されます。

**ショートコードの構成要素:**

| 要素 | 説明 | 例 |
|------|------|-----|
| `amazon` | ショートコード名 | Amazon リンク用のショートコード |
| `asin` | Amazon 商品識別番号 | B003UMOHT0 |
| `title` | 商品タイトル | AnCnoc(アンノック) シングルモルト アンノック12年 |

## セッションログの注意点

### 改行がスペースに変換される問題

**何が起きたか:**
セッションログを確認すると、エージェントへの指示文で改行がスペースに変換されていることがわかりました。

**なぜこれが問題になりうるか:**

元の指示：
```
ウイスキーの記事を書いてください。
以下のポイントを含めてください：
- 初心者向けの説明
- おすすめの銘柄
```

セッションログでの表示：
```
ウイスキーの記事を書いてください。 以下のポイントを含めてください： - 初心者向けの説明 - おすすめの銘柄
```

**初心者向け補足:**
> 💡 改行がスペースになると、箇条書きや段落の区切りがわかりにくくなります。特に長い指示を出す場合、読みにくくなってしまいます。

**対策のヒント:**

1. 重要なポイントは番号を振って明示する（「1.」「2.」など）
2. 区切りを示す記号を使う（「---」「===」など）
3. 短い文で区切って指示を出す
4. 最も重要な指示を最初に書く

## PR #11 の失敗から学ぶこと

### なぜ差分が大きくなりすぎたのか

PR #11 で差分が大きくなりすぎた原因を考察すると、以下のようなパターンが考えられます：

1. **指示があいまいだった**
   - 「ウイスキーの記事を書いて」だけでは、どこまでやるか不明確
   - エージェントが「関連するすべてのこと」を行おうとした可能性

2. **既存ファイルへの変更が多かった**
   - 新規記事だけでなく、設定ファイルやテンプレートにも手を加えた可能性
   - サイト全体の構造に影響する変更を含んでいた可能性

3. **関連する変更をまとめて行った**
   - 「ついでにこれも直しておこう」という最適化
   - 記事に関連する他の改善も含めてしまった

### 小さな差分を保つためのベストプラクティス

```text
✅ 良い例：
- 新しい記事ファイル（1つ）の追加のみ
- 必要な画像ファイル（数個）の追加のみ

❌ 避けるべき例：
- 記事追加 + サイト設定の変更 + テンプレートの修正 + CSS の調整
- 複数の独立した変更を1つの PR にまとめる
```

**教訓:**
> 「一度に一つのことだけを行う」という原則は、AIエージェントへの指示でも重要です。

## エージェントガイドラインの重要性

### なぜガイドラインが効果的だったのか

PR #11 から PR #13 への改善は、エージェントガイドラインの更新によるものでした。

**ガイドラインがもたらす効果:**

1. **一貫性の確保**
   - 毎回同じルールに従って作業が行われる
   - 結果が予測しやすくなる

2. **スコープの制限**
   - 「ここまでやる」「これはやらない」が明確になる
   - 不要な変更を防止できる

3. **品質の向上**
   - 事前に定義された基準に従う
   - 見落としがちな点も自動的にカバー

### ガイドライン設計のポイント

```text
効果的なガイドラインの要素：

1. 明確な役割定義
   - 何をするエージェントなのか
   - 何を期待されているのか

2. 具体的な制約
   - やってはいけないこと
   - 変更してはいけないファイル

3. 出力形式の指定
   - どのような形式で出力するか
   - 使用すべきテンプレートやショートコード

4. 例示
   - 良い例と悪い例
   - 具体的なコードサンプル
```

## よくある質問

### Q: なぜ最初から成功しなかったのですか？

A: AIエージェントは指示に忠実に従おうとしますが、あいまいな指示では「何がベストか」を独自に判断します。その判断が人間の期待と異なることがあります。明確なガイドラインを設定することで、この齟齬を減らすことができます。

### Q: 差分が大きいとなぜダメなのですか？

A: いくつかの理由があります：
- 人間がすべての変更を確認するのが困難になる
- 問題があった場合、原因の特定が難しくなる
- 他の作業者の変更と衝突しやすくなる
- ロールバック（巻き戻し）が複雑になる

### Q: Amazon ショートコードは必須ですか？

A: 必須ではありませんが、使用することで：
- 見た目が統一される
- リンク切れを防ぎやすくなる
- 後からスタイルを一括変更できる

というメリットがあります。

### Q: セッションログの改行問題は解決できますか？

A: 現時点では、GitHub Copilot Tasks のセッションログでは改行がスペースに変換される仕様のようです。対策としては：
- 番号付きリストを使う
- 区切り記号を明示的に使う
- 短い文で区切る

などの工夫が有効です。

## まとめ

このセッションを通じて、以下のことを学ぶことができました：

### 主なポイント

✅ **差分は小さく保つ**: 一度に多くの変更を行わず、小さな単位で作業を進める

✅ **ガイドラインは効果的**: 事前に明確なルールを設定することで、期待通りの結果を得やすくなる

✅ **具体的な指示を出す**: Amazon ショートコードの使用など、具体的な形式を指定する

✅ **失敗から学ぶ**: PR #11 の失敗は、PR #13 の成功につながる貴重な経験だった

### 次のステップ

AIエージェントを活用したブログ記事作成に興味がある方は、以下のことを試してみてください：

1. 自分のプロジェクトでエージェントガイドラインを作成してみる
2. 小さなタスクから始めて、徐々に複雑なタスクに挑戦する
3. 失敗を恐れず、試行錯誤を楽しむ

## 用語集

| 用語 | 意味 |
|------|------|
| GitHub Copilot Tasks | GitHub が提供する AI エージェント機能。コード変更やファイル作成を自動で行う |
| PR（Pull Request） | コードの変更を提案し、レビューを受けるための仕組み |
| 差分（diff） | 変更前と変更後のファイルの違い |
| Hugo | Go 言語で書かれた静的サイトジェネレーター |
| ショートコード | Hugo の機能で、複雑な HTML を短いコードで表現できる仕組み |
| ASIN | Amazon Standard Identification Number。Amazon の商品識別番号 |
| エージェントガイドライン | AI エージェントに対するルールや指示を記述したドキュメント |
| スコープ | 作業の範囲や対象 |
| マージコンフリクト | 複数の変更が衝突して、自動でマージできない状態 |
| ロールバック | 変更を元の状態に戻すこと |

## 参考リンク

- [PR #11: 最初の試み](https://github.com/nqou-net/www.nqou.net/pull/11)
- [PR #11 の Copilot Tasks セッション](https://github.com/copilot/tasks/pull/PR_kwDOJQnkT861RBwf)
- [PR #13: 再挑戦（成功）](https://github.com/nqou-net/www.nqou.net/pull/13)
- [PR #13 の Copilot Tasks セッション](https://github.com/copilot/tasks/pull/PR_kwDOJQnkT861Yyvs)

---

**著者について**

この記事は、article-interviewer プロジェクトの一環として、GitHub Copilot Tasks のセッションを解説する目的で作成されました。

**タグ**: GitHub Copilot Tasks, AI エージェント, ブログ記事作成, Hugo, ショートコード, エージェントガイドライン
